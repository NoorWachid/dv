<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dv: Write Dvorak on Qwerty Layout</title>
    <style>
        * {
            margin: 0px;
            padding: 0px;
            box-sizing: border-box;
        }

        body {
            overflow: hidden;
        }

        #editor,
        #editor:hover,
        #editor:focus,
        #editor:active {
            font-family: monospace;
            border: 0px solid transparent;
            outline: 0px;
        }
        #editor {
            font-size: 16px;
            padding: 8px 12px;
            width: 100%;
            height: 100vh;
            overflow: auto;
        }
    </style>
</head>
<body>
    <textarea tabindex="-1" id="editor" autofocus></textarea>
    <script>
        var editor = document.getElementById('editor');
        var map = {
            'Tab': '\t',
	    // Upper
	    'q': "'",
	    'w': ',',
	    'e': '.',
	    'r': 'p',
	    't': 'y',
	    'y': 'f',
	    'u': 'g',
	    'i': 'c',
	    'o': 'r',
	    'p': 'l',
	    '[': '/',
	    ']': '=',
	    // Upper + Shift
	    'Q': '"',
	    'W': '<',
	    'E': '>',
	    'R': 'P',
	    'T': 'Y',
	    'Y': 'F',
	    'U': 'G',
	    'I': 'C',
	    'O': 'R',
	    'P': 'L',
	    '[': '?',
	    ']': '+',

	    // Middle
	    's': 'o',
	    'd': 'e',
	    'f': 'u',
	    'g': 'i',
	    'h': 'd',
	    'j': 'h',
	    'k': 't',
	    'l': 'n',
	    ';': 's',
	    "'": '-',
	    // Middle + Shift
	    'S': 'O',
	    'D': 'E',
	    'F': 'U',
	    'G': 'I',
	    'H': 'D',
	    'J': 'H',
	    'K': 'T',
	    'L': 'N',
	    ':': 'S',
	    '"': '-',
	
	    // Lower
	    'z': ';',
	    'x': 'q',
	    'c': 'j',
	    'v': 'k',
	    'b': 'x',
	    'n': 'b',
	    ',': 'w',
	    '.': 'v',
	    '/': 'z',
	    // Lower + Shift
	    'Z': ':',
	    'X': 'Q',
	    'C': 'J',
	    'V': 'K',
	    'B': 'X',
	    'N': 'B',
	    '<': 'W',
	    '>': 'V',
	    '?': 'Z',
        };

        editor.addEventListener('keydown', function (event) {
            if (!(event.altKey || event.ctrlKey || event.metaKey) && map[event.key]) {
                event.preventDefault();
                insertNewText(map[event.key]);
            }
        });

        function insertNewText(newText) {
            const start  = editor.selectionStart
            const end    = editor.selectionEnd
            const text   = editor.value
            const before = text.substring(0, start)
            const after  = text.substring(end, text.length)
            editor.value = (before + newText + after)
            editor.selectionStart = editor.selectionEnd = start + newText.length
            editor.focus()
        }

    </script>
</body>
</html>
